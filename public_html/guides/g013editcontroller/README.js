Ext.data.JsonP.g013editcontroller({"guide":"<h2 id='g013editcontroller-section-edit%E3%82%B3%E3%83%B3%E3%83%88%E3%83%AD%E3%83%BC%E3%83%A9%E3%83%BC'>Editコントローラー</h2>\n\n<h3 id='g013editcontroller-section-%E3%82%84%E3%81%A3%E3%81%A6%E3%81%BF%E3%82%88%E3%81%86-%2311'>やってみよう #11</h3>\n\n<p>※ 直前のハンズオンがうまくいかなかった方のために、ここまでの結果を用意しています。\n<a href=\"http://preview.xenophy.com/xenophy/senchaug/egg/misc/cl11.zip\">こちらからダウンロードして</a>\nドキュメントルートのeggディレクトリの下に解凍してください。</p>\n\n<p>ここまででEditパネルが表示できましたが、変更結果を保存させたいと思います。\nEditビューの制御をするEditコントローラーを作成します。</p>\n\n<ul>\n<li><p>Sencha Cmdでコントローラーを作成します。</p>\n\n<pre><code>  sencha generate controller Edit\n</code></pre></li>\n<li><p>app.jsに追加します。</p>\n\n<pre><code>  controllers: [\n      'List',\n      'Detail',\n      'Edit'\n  ],\n</code></pre></li>\n</ul>\n\n\n<h3 id='g013editcontroller-section-refs'>refs</h3>\n\n<pre><code>    refs: {\n        navi: 'contactnavi',\n        edit: 'contactedit',\n        saveButton: 'button#saveButton'\n    },\n</code></pre>\n\n<h3 id='g013editcontroller-section-control'>control</h3>\n\n<pre><code>    control: {\n        edit: {\n            show: 'onShow',\n            hide: 'onHide'\n        },\n        saveButton: {\n            tap: 'onSaveData'\n        }\n    }\n</code></pre>\n\n<h3 id='g013editcontroller-section-%E3%83%8F%E3%83%B3%E3%83%89%E3%83%A9%E3%83%BC'>ハンドラー</h3>\n\n<ul>\n<li><p><code>onShow</code>と<code>onHide</code>では、ボタンの表示を制御します。</p>\n\n<pre><code>  onShow: function() {\n      this.getSaveButton().show();\n  },\n\n  onHide: function () {\n      this.getSaveButton().hide();\n  },\n</code></pre></li>\n<li><p><code>onSaveData</code>では入力／訂正されたデータを保存します。</p>\n\n<pre><code>  onSaveData: function() {\n      var me = this, \n          record = me.getEdit().getRecord(),\n          data = me.getEdit().getValues(),\n          store = Ext.getStore('Contacts');\n\n      record.set(data);\n      if( record.phantom ) {\n          store.add(record);\n      }\n      Ext.getStore('Contacts').sync();\n      me.getNavi().pop();\n  }\n</code></pre></li>\n<li><p>モデルの<code>phantom</code>というプロパティを見ると、そのモデルが新規か訂正かを判断できます。</p></li>\n<li>新規の場合にはストアの<code>add</code>メソッドで追加しています。</li>\n<li>ストアのsyncメソッドを呼ぶと、ストアに対して施された変更を実際のデータソースに反映します。</li>\n</ul>\n\n","title":"Editコントローラー"});